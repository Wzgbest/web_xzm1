<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=duOUzCcv4fenBaOVSORs3uyd9AMTaNNF"></script>
		<style>
			html,body,#mapLocation{
				margin: 0;
				width:100%;
				height: 100%;
			}	
		</style>
	</head>
	<body>
		<div id="mapLocation">
			
		</div>
	<script>
		var lng = window.parent.$("#mapFrame").attr("data-lng");
		var lat = window.parent.$("#mapFrame").attr("data-lat");
		// console.log(lng,lat);
		
		if(lng&&lat){
			var map = new BMap.Map("mapLocation", {enableMapClick:false}); 
			var point = new BMap.Point(lng,lat);
			map.disableDragging();
		}else{
			var map = new BMap.Map("mapLocation"); 
			var point = new BMap.Point(119.13248199999998, 36.707589999999996);
		}

		
		// var point = new BMap.Point(119.13248199999998, 36.707589999999996);
		map.centerAndZoom(point, 12);  // 初始化地图,设置中心点坐标和地图级别
		
	//	map.addEventListener("tilesloaded",function(){alert("地图加载完毕");});
//		map.addControl(new BMap.MapTypeControl());   //添加地图类型控件
		map.setCurrentCity("潍坊");          // 设置地图显示的城市 此项是必须设置的
		map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
		
		var marker = new BMap.Marker(point);// 创建标注
		map.addOverlay(marker);             // 将标注添加到地图中
		marker.enableDragging();
		
		var local = new BMap.LocalSearch(map, {
			renderOptions:{map: map}
		});
		function searchKey(key){
			local.search(key);
		}
		
		
		
		
		function showInfo(e){
			map.clearOverlays(); 
			let marker =new BMap.Marker(e.point);
			map.addOverlay(marker);  
/*			console.log(e.point);
			console.log(marker.point);
			console.log(e.point.lng,e.point.lat);*/
//			window.parent.$("#mapFrame").siblings("input[name='location']").val("("+e.point.lng+","+e.point.lat+")");
			window.parent.$("#mapFrame").siblings("input[name='lng']").val(e.point.lng);
			window.parent.$("#mapFrame").siblings("input[name='lat']").val(e.point.lat);
		}
		map.addEventListener("click", showInfo);
	</script>
	</body>
</html>
